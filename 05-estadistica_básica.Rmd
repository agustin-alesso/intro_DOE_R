# Revisión de estadística básica

En este capítulo revisaremos algunos conceptos y términos estadísticos básicos que necesitaremos para el entender el diseño y análisis estadístico de datos provenientes de estudios observacionales y experimentales. Revisaremos:

- Concepto y utilidad de la Estadística
- Tipos de datos y variables
- Población y muestra
- Estadística descriptiva
- Distribuciones de probabilidades
- Inferencia estadística

## ¿Qué es la estadística?

Existen muchas definiciones de _Estadística_, tantas como libros consultemos. Según Ott y Longnecker (2016), la estadística es la ciencia del diseño de estudios o experimentos, recolección de datos y modelado/análisis de los mismos para la toma de decisiones o descubrimiento de nuevo conocimiento cuando la información disponible es limitada y variable. En resumen, **la estadística es la ciencia del aprendizaje a partir de los datos** (_learning from data_) y está muy emparentada con la aplicación del **método científico**. 

Según este enfoque, el proceso de aprender a partir de los datos implica las siguientes etapas:  

1. **Definición del problema de estudio.** Todo estudio o investigación surge de una pregunta de investigación. Un interrogante sobre nuestro objeto de estudio que no ha sido respondido aún con la información existente y por lo tanto motiva la búsqueda de más información (nuevos experimentos o muestreos) para verificar las posibles respuestas o modelos que nos permitan representarlo (hipótesis). De este modo, a partir de la identificación del problema o pregunta de estudio ponemos de relieve cual es la información que debemos recolectar, cuales son las variables que intervienen en el proceso, cuales hay que controlar y cuales hay que alterar para ver la resupuesta, que tipo de datos se van a trabajar, etc. 

2. **Recolección de los datos.** Una vez definido el problema de estudio, necesitamos determinar de que manera se colectará la información relevante. Para ello debemos diseñar muestreos o experimentos que permitan de manera costo efectiva, obtener la mayor cantidad de información empleando el menor tiempo y dinero para logarar responder de manera precisa la pregunta que originó el estudio. La estadísitca brinda herramientas para el esto.

3. **Resumen de la información.** Luego de recolectar los datos, debemos organizadorlos y resumirlos mediante técnicas núméricas o gráficas para facilitar su exploración y el reconocimiento de las principales características o patrones de los mismos (tendencias, variabilidad, anomalías, etc.). La _estadística descriptiva_ brinda las herramientas necesarias para la descripción de la información proveniente de muestreos o experimentos.

4. **Análisis, interpretación y comunicación de los resultados.** Los datos provenientes de muestreos o experimentos son una pequeña parte (_muestra_) de un conjunto más grande (_población_) el cual es imposible observar en su totalidad. Debemos analizar la información de la muestra para realizar generalizaciones y poder interpretar los resultados en la población. La estadística inferencial brinda herramientas para estimar y valorar los modelos definidos en la Etapa 1 a la luz de los datos recolectados en la Etapa 2 considerando la variabilidad del proceso que los generó. 

## Variables

Las variables son características de interés que se observan o miden en la unidad de observación más pequeña. Al contrario que las constantes, las variables toman diferentes valores de una individuo a otro, i.e. varían. Podemos clasificar las variables según el tipo de datos e información que contienen.

### Tipos de datos

Según el tipo de datos, las variables son:

- *Cualitativas*: que expresan una **cualidad** o atributo no numéricos. _e.g. color de pelo, sexo, estatus sanitario, estado fenológico._
- *Cuantitativas*: que expresan una **cantidad discreta** (_e.g. número de ramas, número de insectos_) o **contínua** (_e.g. peso de granos, contenido de MO del suelo_).

### Escala de medición

Según la cantidad de información que contienen (de menor a mayor) las variables se clasifican en:

- **Nominal**: cualitativa (_el número de identificación o RP de una vaca_)
- **Ordinal**: cualitativa con orden (_posición en el ranking del control lechero_)
- **De intervalo**: cuantitativa, orden y distancias (_fecha del último parto_)
- **De razón**: cuantitativa, orden, distancia y proporciones (_días desde el último parto_)

La escala de medición determina la cantidad de información que tienen y que métodos podemos aplicar. Siempre podemos analizar variables más completas con técnicas de variables más simples. No obstante, este procedimiento implica que perdamos información. Por ejemplo, una variable numérica de intervalo o razón podemos convertirla en nominal u ordinal generando intervalos de clases y contabilizar las frecuencias de cada clase. Por el contrario, las variables más simples no pueden ser analizadas con técnicas diseñadas para variables más completas. Ejemplo: no podemos obtener el promedio de una variable _nominal_ como el color de pelo.

## Población y muestra

Desde el punto de vista estadístico, una **Población** es la totalidad de las unidades u observaciones individuales sobre la cuales queremos _realizar la inferencia_. Está _definida en el tiempo y espacio_ y se caracteriza por sus _parámetros_, i.e. la media $\mu$. Las poblaciones pueden ser finitas, i.e. podemos contar la totalidad de elementos que contienen, o infinita, i.e. no los podemos contar. En la mayoría de los casos, los métodos estadísticos asumen que la población es infinita o finitas pero tan grandes que a los efectos prácticos puede asumirse que son infinitas.

Por su parte, una **muestra** es un subconjunto de individuos u observaciones individuales que elegimos de la población. Las muestras son finitas y se caracterizan por sus _estadísticos_  que son la versión muestral de los parámetros poblacionales, i.e. la media muestral $\bar{y}$. Si el procedimiento que utilizamos para obtener la muestra es aleatorio entonces podemos asumir que la muestra tendrá las mismas propiedades que la población y por lo tanto podemos usar dicha información para inferencia características de la poblaicón. 

En el siguiente gráfico resume el concepto general de la inferencia estadística. Supongamos que queremos conocer el valor medio de las alturas (_parámetro_) en m de plantas de maíz de un lote de 50 has, i.e. $\mu = ?$. El conjunto más grande denominado _Población_ contiene las alturas en m de todas las plantas de maíz del lote en estudio y sobre el que se quiere hacer la inferencia (los $\dots$ indican que en el gráfico no están representados todos los valores). Cada planta es una _unidad de muestreo_ porque la elegimos individualmente, y una _unidad observacional_ porque a cada planta le medimos la altura (observación). Aquellas alturas en rojo corresponden a las 6 plantas que seleccionamos mediante un _muestreo aleatorio_ para componer la muestra ($n = 6$). La altura promedio de las plantas de la muestra (_estadístico_) es $\bar{y} = 1.728$. Dado que el muestreo fue realizado al azar, el estadístico calculado a partir de la muestra brinda información sobre lo que pasa a nivel poblacional ($\mu$). A su vez, la aleatoriedad del muestreo determina que si repitieramos el muestreo de 6 unidades muchas veces, el estadístico muestral tomaría distintos valores cada vez ya que es una _variable aleatoria_. Finalmente, a partir de la _distribución de probabilidades_ asociada a los posibles valores que tomaría el estadístico muestral podemos realizar la inferencia sobre el parámetro poblacional incorporando la variabilidad del muestreo.

```{r, fig.cap="Esquema del proceso de inferencia estadística", out.width="80%"}
include_graphics("images/poblacion_muestra_venn.svg",  auto_pdf = T)
```

## Estadística descriptiva

Conjunto de técnicas y métodos para organizar, resumir y describir los datos.

### Tablas de frecuencias

\newcommand{\LI}{\text{LI}}
\newcommand{\LS}{\text{LS}}
\newcommand{\MC}{\text{MC}}

Una tabla de frecuencias es un listado de los valores de la variable (individuales o agrupados en **clases**) y sus **frecuencias** o conteos correspondientes. Es útil para resumir variables categóricas, discretas o conjuntos de datos cuantitativos contínuos grandes $n > 25$. 

Se definen varios tipos de frecuencias: 

- **Frecuancias simples**: número de veces que un valor o clase está representado en la muestra o población. 
  - _Absolutas_ si se expresan como conteo ($f_i$) 
  - _Relativas_ si es en relación al total de observaciones ($h_i = f_i/n$)

- **Frecuencias acumuladas**: número de veces que un valor o clase y los anteriores están representado en la muestra o población.
  - _Absolutas_ si se expresan como conteo ($F_i$) 
  - _relativas_ si es en relación al total de obsevraciones ($H_i = F_i/n$)

El intervalo que define a una clase tiene **límites de clase**, siendo límites inferior ($\LI$) y superior ($\LS$), siendo generalmente semiabiertos a derecha `[ )`. La diferencia o distancia entre dos $\LI$ o $\LS$ consecutivos se denomina **amplitud de clase**, $c = \LI_{i} - \LI_{i-1}$ y la **marca de clase** es el valor central de la clase, i.e. promedio entre los límites o bien $\MC = \LI + 0.5 c$

Si bien no hay un criterio estricto para determinar el número de clases, generalmente entre 5 y 20 clases de igual amplitud es adecuado. 

Mediante el En el ejemplo de CO del suelo, dado que la muestra tiene 40 observaciones se podría examinar la distribución de frecuencias

```{r, eval = F, echo = T}
# Cargar los datos
library(readxl)
lotes <- read_excel("Lotes_CO.xls")
lotes
```

```{r, eval = T, echo = F}
# Cargar los datos
library(readxl)
lotes <- read_excel("./data/Lotes_CO.xls")
lotes
```

## 

```{r, eval = T, echo = T}
# Definir los intervalos
lim <- with(lotes, pretty(CO, n = 8))
lim

# Dividir los datos en clases
library(dplyr)
lotes <- mutate(lotes, clases = cut(CO, breaks = lim, include.lowest = T, right = F))
lotes
```

A cada observación se agrega una variable categórica que indica a que clase pertenece.

## 

Luego agrupando por cada `clase` y haciendo el conteo se obtiene las frecuencias `n`

```{r}
# Obtener frecuencias simples absolutas
tabla <- group_by(lotes, clases)
tabla <- summarise(tabla, f = n())
tabla
```

Como no aparece la categoría `[4.5, 5)` hay que agregarla usando `complete()`

```{r}
# Rellenar con clases faltantes
library(tidyr)
tabla <- complete(tabla, clases, fill = list(f = 0))
tabla
```

##

```{r}
# Calcular marcas de clase: LI + 1/2 amplitud clase
c <- 0.5
mc <- lim[1:9] + 0.5 * c
mc

# Agregar marcas de clase
tabla$mc <- mc
tabla
```

## 

```{r}
# Agregar otras frecuencias
tabla <- mutate(tabla, F = cumsum(f), h = f/sum(f), H = F/sum(f))
tabla
```

_¿Que nos dice esta tabla?_


### Gráficos

- Histogramas
- Gráficos de barras
- Box-plots
- Dispersión

### Medidas de resumen

- Tendencia central: media, mediana, modo
- Dispersión: varianza (desvío), rango, rango intercuartílico
- Posición: percentiles
- Forma: sesgo o asimetría y curtosis

## distribuciones (directamente la normal y TCL)

## IC

## Test hipotesis